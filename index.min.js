let data,network,histogram,word_cloud,pie_chart,data_table,rank=200,max_rank=200,code_search="TRUE",language="Java",final_rank;function update(){filtered_data=data.filter(a=>a.rank<=rank).filter(a=>"BOTH"===code_search||a.code_search===code_search).filter(a=>a.language===language),d3.select("#data_output_range").attr("max",max_rank),d3.select("#data_output_range").attr("value",rank),d3.select("#data_output_rate").text(Math.ceil(rank/max_rank*100)),d3.select("#data_output_max").text(rank),color="Java"===language?d3.interpolateReds:d3.interpolateGreens,network.update(filtered_data,final_rank,color),histogram.update(network.transform(filtered_data)),word_cloud.update(filtered_data),pie_chart.update(filtered_data),data_table.update(filtered_data)}d3.select("#data_output_range").on("change",a=>{rank=a.target.value,update()}),d3.selectAll(".search_type").on("change",a=>{code_search=a.target.value,update()}),d3.selectAll(".language_type").on("change",a=>{language=a.target.value,update()}),d3.csv("https://bonohubby.github.io/infovis/data.csv").then(a=>{data=a.map(a=>({query_id:parseInt(a.query_id),query:a.query,url_id:parseInt(a.url_id),url:a.url,origin_url:a.origin_url,domain_id:parseInt(a.domain_id),domain:a.domain,rank:parseInt(a.rank),code_search:a.code_search,language:a.language})),max_rank=final_rank=d3.max(data,a=>a.rank),network=new Network("#network",1e3,500),histogram=new Histogram("#histogram",1e3,500),word_cloud=new WordCloud("#word_cloud",500,500,["java","c#"]),pie_chart=new PieChart("#pie_chart"),data_table=new DataTable("#data_table",["queries","url","domain","code_search","language"]),update()});